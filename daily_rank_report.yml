  name: Daily Game Rank Report
    
     on:
       schedule:
         # 매일 오전 9시 (UTC 기준, 한국 시간은 UTC+9이므로 00:00 UTC)
         - cron: '0 0 * * *'
       workflow_dispatch: # 수동 실행을 위한 트리거
    
     jobs:
      build:
        runs-on: ubuntu-latest # GitHub Actions는 Linux 환경에서 실행됩니다.
   
        steps:
        - name: Checkout repository
          uses: actions/checkout@v4
   
        - name: Set up Python
          uses: actions/setup-python@v5
          with:
            python-version: '3.9' # 사용 중인 Python 버전에 맞게 변경 (예: '3.8', '3.9', '3.10')
   
        - name: Install dependencies
          run: |
            python -m pip install --upgrade pip
            pip install beautifulsoup4 selenium google-cloud-translate webdriver-manager
   
        - name: Create Google Cloud Key file
          env:
            GOOGLE_CREDENTIALS: ${{ secrets.GOOGLE_CREDENTIALS }} # GitHub Secrets에서 가져옴
          run: |
            echo "$GOOGLE_CREDENTIALS" > my-gcp-key.json
   
        - name: Run the script
          env:
            REPORT_EMAIL: ${{ secrets.REPORT_EMAIL }}
            SENDER_EMAIL: ${{ secrets.SENDER_EMAIL }}
            SENDER_PASSWORD: ${{ secrets.SENDER_PASSWORD }}
            SMTP_SERVER: ${{ secrets.SMTP_SERVER }}
            SMTP_PORT: ${{ secrets.SMTP_PORT }}
          run: |
            python game_rank_notifier.py \
              --email "$REPORT_EMAIL" \
              --sender_email "$SENDER_EMAIL" \
              --sender_password "$SENDER_PASSWORD" \
              --smtp_server "$SMTP_SERVER" \
              --smtp_port "$SMTP_PORT"